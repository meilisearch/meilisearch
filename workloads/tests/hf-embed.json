{
    "type": "test",
    "name": "hf-embed",
    "binary": {
        "source": "release",
        "edition": "community",
        "version": "1.14.0"
    },
    "assets": {
        "movies-100.json": {
            "local_location": null,
            "remote_location": "https://milli-benchmarks.fra1.digitaloceanspaces.com/bench/datasets/movies-100.json",
            "sha256": "d215e395e4240f12f03b8f1f68901eac82d9e7ded5b462cbf4a6b8efde76c6c6"
        }
    },
    "commands": [
        {
            "route": "indexes/movies/settings",
            "method": "PATCH",
            "body": {
                "inline": {
                    "filterableAttributes": [
                        "genres",
                        "release_date"
                    ],
                    "searchableAttributes": [
                        "title",
                        "overview"
                    ],
                    "sortableAttributes": [
                        "release_date"
                    ]
                }
            },
            "expectedStatus": 202,
            "expectedResponse": {
                "enqueuedAt": "[timestamp]",
                "indexUid": "movies",
                "status": "enqueued",
                "taskUid": 0,
                "type": "settingsUpdate"
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/settings",
            "method": "PATCH",
            "body": {
                "inline": {
                    "embedders": {
                        "default": {
                            "source": "huggingFace"
                        }
                    }
                }
            },
            "expectedStatus": 202,
            "expectedResponse": {
                "enqueuedAt": "[timestamp]",
                "indexUid": "movies",
                "status": "enqueued",
                "taskUid": 1,
                "type": "settingsUpdate"
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/documents",
            "method": "POST",
            "body": {
                "asset": "movies-100.json"
            },
            "expectedStatus": 202,
            "expectedResponse": {
                "enqueuedAt": "[timestamp]",
                "indexUid": "movies",
                "status": "enqueued",
                "taskUid": 2,
                "type": "documentAdditionOrUpdate"
            },
            "synchronous": "WaitForTask"
        },
        {
            "route": "indexes/movies/search",
            "method": "POST",
            "body": {
                "inline": {
                    "attributesToRetrieve": [
                        "title",
                        "overview"
                    ],
                    "hybrid": {
                        "embedder": "default",
                        "semanticRatio": 1.0
                    },
                    "limit": 5,
                    "q": "Police",
                    "showRankingScore": true
                }
            },
            "expectedStatus": 200,
            "expectedResponse": {
                "estimatedTotalHits": 99,
                "hits": [
                    {
                        "_rankingScore": 0.2991647720336914,
                        "overview": "A hard-nosed cop reluctantly teams up with a wise-cracking criminal temporarily paroled to him, in order to track down a killer.",
                        "title": "48 Hrs."
                    },
                    {
                        "_rankingScore": 0.20632648468017575,
                        "overview": "Young Treasury Agent Elliot Ness arrives in Chicago and is determined to take down Al Capone, but it is not going to be easy because Capone has the police in his pocket. Ness meets Jimmy Malone, a veteran patrolman and probably the most honorable one on the force. He asks Malone to help him get Capone, but Malone warns him that if he goes after Capone, he is going to war.",
                        "title": "The Untouchables"
                    },
                    {
                        "_rankingScore": 0.1864612102508545,
                        "overview": "Axel heads for the land of sunshine and palm trees to find out who shot police Captain Andrew Bogomil. Thanks to a couple of old friends, Axel is investigation uncovers a series of robberies masterminded by a heartless weapons kingpin—and the chase is on.",
                        "title": "Beverly Hills Cop II"
                    },
                    {
                        "_rankingScore": 0.18349123001098633,
                        "overview": "An average family is thrust into the spotlight after the father commits a seemingly self-defense murder at his diner.",
                        "title": "A History of Violence"
                    },
                    {
                        "_rankingScore": 0.1784205436706543,
                        "overview": "One man defeated three assassins who sought to murder the most powerful warlord in pre-unified China.",
                        "title": "Hero"
                    }
                ],
                "limit": 5,
                "offset": 0,
                "processingTimeMs": "[duration]",
                "query": "Police",
                "semanticHitCount": 5
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/settings/embedders",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": {
                "default": {
                    "documentTemplate": "{% for field in fields %}{% if field.is_searchable and field.value != nil %}{{ field.name }}: {{ field.value }}\n{% endif %}{% endfor %}",
                    "documentTemplateMaxBytes": 400,
                    "model": "BAAI/bge-base-en-v1.5",
                    "pooling": "useModel",
                    "revision": "617ca489d9e86b49b8167676d8220688b99db36e",
                    "source": "huggingFace"
                }
            },
            "synchronous": "WaitForResponse"
        },
        {
            "binary": {
                "source": "build",
                "edition": "community",
                "extraCliArgs": [
                    "--experimental-dumpless-upgrade",
                    "--experimental-max-number-of-batched-tasks=0"
                ]
            }
        },
        {
            "route": "experimental-features",
            "method": "PATCH",
            "body": {
                "inline": {
                    "vectorStoreSetting": true
                }
            },
            "expectedStatus": 200,
            "expectedResponse": {
                "chatCompletions": false,
                "compositeEmbedders": false,
                "containsFilter": false,
                "editDocumentsByFunction": false,
                "getTaskDocumentsRoute": false,
                "logsRoute": true,
                "metrics": false,
                "multimodal": false,
                "network": false,
                "vectorStoreSetting": true
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/search",
            "method": "POST",
            "body": {
                "inline": {
                    "attributesToRetrieve": [
                        "title",
                        "overview"
                    ],
                    "hybrid": {
                        "embedder": "default",
                        "semanticRatio": 1.0
                    },
                    "limit": 5,
                    "q": "Police",
                    "showRankingScore": true
                }
            },
            "expectedStatus": 200,
            "expectedResponse": {
                "estimatedTotalHits": 99,
                "hits": [
                    {
                        "_rankingScore": 0.2991647720336914,
                        "overview": "A hard-nosed cop reluctantly teams up with a wise-cracking criminal temporarily paroled to him, in order to track down a killer.",
                        "title": "48 Hrs."
                    },
                    {
                        "_rankingScore": 0.20632648468017575,
                        "overview": "Young Treasury Agent Elliot Ness arrives in Chicago and is determined to take down Al Capone, but it is not going to be easy because Capone has the police in his pocket. Ness meets Jimmy Malone, a veteran patrolman and probably the most honorable one on the force. He asks Malone to help him get Capone, but Malone warns him that if he goes after Capone, he is going to war.",
                        "title": "The Untouchables"
                    },
                    {
                        "_rankingScore": 0.1864612102508545,
                        "overview": "Axel heads for the land of sunshine and palm trees to find out who shot police Captain Andrew Bogomil. Thanks to a couple of old friends, Axel is investigation uncovers a series of robberies masterminded by a heartless weapons kingpin—and the chase is on.",
                        "title": "Beverly Hills Cop II"
                    },
                    {
                        "_rankingScore": 0.18349123001098633,
                        "overview": "An average family is thrust into the spotlight after the father commits a seemingly self-defense murder at his diner.",
                        "title": "A History of Violence"
                    },
                    {
                        "_rankingScore": 0.1784205436706543,
                        "overview": "One man defeated three assassins who sought to murder the most powerful warlord in pre-unified China.",
                        "title": "Hero"
                    }
                ],
                "limit": 5,
                "offset": 0,
                "processingTimeMs": "[duration]",
                "query": "Police",
                "requestUid": "[uuid]",
                "semanticHitCount": 5
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/settings/embedders",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": {
                "default": {
                    "documentTemplate": "{% for field in fields %}{% if field.is_searchable and field.value != nil %}{{ field.name }}: {{ field.value }}\n{% endif %}{% endfor %}",
                    "documentTemplateMaxBytes": 400,
                    "model": "BAAI/bge-base-en-v1.5",
                    "pooling": "useModel",
                    "revision": "617ca489d9e86b49b8167676d8220688b99db36e",
                    "source": "huggingFace"
                }
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/settings/vector-store",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": null,
            "synchronous": "WaitForResponse"
        },
        {
            "binary": {
                "source": "build",
                "edition": "community",
                "extraCliArgs": [
                    "--experimental-dumpless-upgrade"
                ]
            }
        },
        {
            "route": "health",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": {
                "status": "available"
            },
            "synchronous": "WaitForTask"
        },
        {
            "route": "indexes/movies/settings/vector-store",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": null,
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/search",
            "method": "POST",
            "body": {
                "inline": {
                    "attributesToRetrieve": [
                        "title",
                        "overview"
                    ],
                    "hybrid": {
                        "embedder": "default",
                        "semanticRatio": 1.0
                    },
                    "limit": 5,
                    "q": "Police",
                    "showRankingScore": true
                }
            },
            "expectedStatus": 200,
            "expectedResponse": {
                "estimatedTotalHits": 99,
                "hits": [
                    {
                        "_rankingScore": 0.2991647720336914,
                        "overview": "A hard-nosed cop reluctantly teams up with a wise-cracking criminal temporarily paroled to him, in order to track down a killer.",
                        "title": "48 Hrs."
                    },
                    {
                        "_rankingScore": 0.20632648468017575,
                        "overview": "Young Treasury Agent Elliot Ness arrives in Chicago and is determined to take down Al Capone, but it is not going to be easy because Capone has the police in his pocket. Ness meets Jimmy Malone, a veteran patrolman and probably the most honorable one on the force. He asks Malone to help him get Capone, but Malone warns him that if he goes after Capone, he is going to war.",
                        "title": "The Untouchables"
                    },
                    {
                        "_rankingScore": 0.1864612102508545,
                        "overview": "Axel heads for the land of sunshine and palm trees to find out who shot police Captain Andrew Bogomil. Thanks to a couple of old friends, Axel is investigation uncovers a series of robberies masterminded by a heartless weapons kingpin—and the chase is on.",
                        "title": "Beverly Hills Cop II"
                    },
                    {
                        "_rankingScore": 0.18349123001098633,
                        "overview": "An average family is thrust into the spotlight after the father commits a seemingly self-defense murder at his diner.",
                        "title": "A History of Violence"
                    },
                    {
                        "_rankingScore": 0.1784205436706543,
                        "overview": "One man defeated three assassins who sought to murder the most powerful warlord in pre-unified China.",
                        "title": "Hero"
                    }
                ],
                "limit": 5,
                "offset": 0,
                "processingTimeMs": "[duration]",
                "query": "Police",
                "requestUid": "[uuid]",
                "semanticHitCount": 5
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "indexes/movies/settings/embedders",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": {
                "default": {
                    "documentTemplate": "{% for field in fields %}{% if field.is_searchable and field.value != nil %}{{ field.name }}: {{ field.value }}\n{% endif %}{% endfor %}",
                    "documentTemplateMaxBytes": 400,
                    "model": "BAAI/bge-base-en-v1.5",
                    "pooling": "useModel",
                    "revision": "617ca489d9e86b49b8167676d8220688b99db36e",
                    "source": "huggingFace"
                }
            },
            "synchronous": "WaitForResponse"
        },
        {
            "route": "tasks",
            "method": "GET",
            "body": null,
            "expectedStatus": 200,
            "expectedResponse": {
                "from": 3,
                "limit": 20,
                "next": null,
                "results": [
                    {
                        "batchUid": 3,
                        "canceledBy": null,
                        "details": {
                            "upgradeFrom": "v1.14.0",
                            "upgradeTo": "[latest]"
                        },
                        "duration": "[duration]",
                        "enqueuedAt": "[timestamp]",
                        "error": null,
                        "finishedAt": "[timestamp]",
                        "indexUid": null,
                        "startedAt": "[timestamp]",
                        "status": "succeeded",
                        "type": "upgradeDatabase",
                        "uid": 3
                    },
                    {
                        "batchUid": 2,
                        "canceledBy": null,
                        "details": {
                            "indexedDocuments": 99,
                            "receivedDocuments": 99
                        },
                        "duration": "[duration]",
                        "enqueuedAt": "[timestamp]",
                        "error": null,
                        "finishedAt": "[timestamp]",
                        "indexUid": "movies",
                        "startedAt": "[timestamp]",
                        "status": "succeeded",
                        "type": "documentAdditionOrUpdate",
                        "uid": 2
                    },
                    {
                        "batchUid": 1,
                        "canceledBy": null,
                        "details": {
                            "embedders": {
                                "default": {
                                    "source": "huggingFace"
                                }
                            }
                        },
                        "duration": "[duration]",
                        "enqueuedAt": "[timestamp]",
                        "error": null,
                        "finishedAt": "[timestamp]",
                        "indexUid": "movies",
                        "startedAt": "[timestamp]",
                        "status": "succeeded",
                        "type": "settingsUpdate",
                        "uid": 1
                    },
                    {
                        "batchUid": 0,
                        "canceledBy": null,
                        "details": {
                            "filterableAttributes": [
                                "genres",
                                "release_date"
                            ],
                            "searchableAttributes": [
                                "title",
                                "overview"
                            ],
                            "sortableAttributes": [
                                "release_date"
                            ]
                        },
                        "duration": "[duration]",
                        "enqueuedAt": "[timestamp]",
                        "error": null,
                        "finishedAt": "[timestamp]",
                        "indexUid": "movies",
                        "startedAt": "[timestamp]",
                        "status": "succeeded",
                        "type": "settingsUpdate",
                        "uid": 0
                    }
                ],
                "total": 4
            },
            "synchronous": "WaitForResponse"
        }
    ]
}